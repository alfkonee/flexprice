# Example: Minimal Development Setup
# This configuration is suitable for local development and testing.
# Uses operators with minimal resources.

flexprice:
  image:
    repository: flexprice/flexprice
    tag: "latest"
  
  deploymentMode: "docker"
  
  api:
    replicas: 1
    resources:
      requests:
        memory: "128Mi"
        cpu: "50m"
      limits:
        memory: "512Mi"
        cpu: "500m"
  
  consumer:
    replicas: 1
    resources:
      requests:
        memory: "128Mi"
        cpu: "50m"
      limits:
        memory: "512Mi"
        cpu: "500m"
  
  worker:
    replicas: 1
    resources:
      requests:
        memory: "128Mi"
        cpu: "50m"
      limits:
        memory: "512Mi"
        cpu: "500m"
  
  service:
    type: NodePort

# PostgreSQL (minimal)
postgres:
  operator:
    enabled: true
    instances: 1
    storage:
      size: "10Gi"
    resources:
      requests:
        memory: "256Mi"
        cpu: "100m"
      limits:
        memory: "512Mi"
        cpu: "500m"
    connectionPooling:
      enabled: false
    backup:
      enabled: false

# ClickHouse (minimal)
clickhouse:
  operator:
    enabled: true
    cluster:
      shardsCount: 1
      replicasCount: 1
    storage:
      size: "20Gi"
    resources:
      requests:
        memory: "512Mi"
        cpu: "250m"
      limits:
        memory: "1Gi"
        cpu: "1000m"
    zookeeper:
      enabled: false

# Redpanda (minimal)
kafka:
  operator:
    enabled: true
    replicas: 1
    storage:
      size: "20Gi"
    resources:
      cpu: "0.5"
      memory: "1Gi"
  topics:
    - name: "events"
      partitions: 3
      replicationFactor: 1
    - name: "events_lazy"
      partitions: 3
      replicationFactor: 1
    - name: "events_post_processing"
      partitions: 3
      replicationFactor: 1
    - name: "system_events"
      partitions: 1
      replicationFactor: 1
    - name: "wallet_alert"
      partitions: 1
      replicationFactor: 1

# Temporal
# Note: For minimal development, use an external Temporal or Temporal Cloud
# Installing Temporal requires PostgreSQL database configuration
temporal:
  operator:
    install: false  # Don't install Temporal chart (requires database setup)
    enabled: true   # Still enable Temporal features (connect to external instance)
  # For development, you can run Temporal locally with:
  # docker run --rm -p 7233:7233 temporalio/auto-setup:latest
  external:
    enabled: true
    address: "temporal:7233"  # Update to your Temporal address
    namespace: "default"
    tls: false

# Logging
observability:
  logging:
    level: "debug"

# Migrations
migrations:
  enabled: true
  runAsJob: true
